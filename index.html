<!DOCTYPE HTML>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,minimal-ui,viewport-fit=cover">
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-touch-fullscreen" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black" />
	<meta name="mobile-web-app-orientation" content="landscape">
	<meta name="screen-orientation" content="landscape">
	<meta name="x5-orientation" content="landscape">
	<meta name="x5-fullscreen" content="true">
	<meta name="360-fullscreen" content="true">
	<meta name="full-screen" content="yes">
	<title>å°çƒæ¸¸æˆ | ç§»åŠ¨ç«¯ä¼˜åŒ–ç‰ˆ</title>
	<meta name="description" content="å°çƒæ¸¸æˆ - ç§»åŠ¨ç«¯ä¼˜åŒ–ç‰ˆ">
	<meta name="keywords" content="å°çƒ,8çƒ,ä½“è‚²æ¸¸æˆ,æ‰‹æœºæ¸¸æˆ">
	<style type="text/css">
		body{margin:0;padding:0;font-size:12px;background:url(res/wood.jpg); touch-action: manipulation;}

/* åŸºç¡€å®¹å™¨æ ·å¼ */
#container {
    width: 100vw;
    height: 100vh;
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    margin: 0;
    padding: 0;
}

/* æ¨ªå±æ¨¡å¼æ ·å¼ */
@media (orientation: landscape) {
    #container {
        width: 100vw;
        height: 100vh;
        position: absolute;
        top: 0;
        left: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        background-size: cover;
        background-position: center;
    }
    
    /* æ¸¸æˆç”»å¸ƒé€‚é… */
    #container canvas {
        max-width: 100vw;
        max-height: 100vh;
        width: auto !important;
        height: auto !important;
        object-fit: contain;
        display: block;
    }
    
    .virtual-controls {
        flex-direction: column;
        left: 2vw;
        right: auto;
        bottom: 2vh;
        top: 2vh;
        align-items: center;
        justify-content: center;
        gap: 1.5vh;
        background: rgba(0, 0, 0, 0.2);
        transform-origin: bottom left;
    }
    
    .virtual-controls .control-button {
        /* æ¨ªå±æ¨¡å¼ä¸‹ä¿æŒè‡ªåŠ¨ç¼©æ”¾ */
        width: min(8vw, 6vh, 60px);
        height: min(8vw, 6vh, 60px);
        font-size: min(4vw, 3vh, 20px);
        margin: 0.5vh 0;
    }
    
    .virtual-controls .control-button.special {
        width: min(10vw, 8vh, 70px);
        height: min(10vw, 8vh, 70px);
        font-size: min(5vw, 4vh, 24px);
    }
}

/* ç«–å±æ¨¡å¼æç¤º */
.portrait-warning {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.95);
    color: white;
    display: none;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    z-index: 9999;
    padding: 20px;
    animation: fadeIn 0.3s ease;
}

.portrait-warning.visible {
    display: flex;
}

.portrait-warning-icon {
    font-size: 64px;
    margin-bottom: 30px;
    animation: rotate 2s ease-in-out infinite;
}

.portrait-warning-text {
    font-size: 20px;
    line-height: 1.6;
    max-width: 300px;
    margin-bottom: 30px;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes rotate {
    0%, 100% { transform: rotate(0deg); }
    50% { transform: rotate(90deg); }
}
		
		/* ç§»åŠ¨ç«¯è™šæ‹Ÿæ§åˆ¶å™¨ */
	.virtual-controls {
		display: none;
		position: fixed;
		right: 2vw;
		bottom: 2vh;
		flex-direction: column;
		gap: 1.5vh;
		z-index: 1001;
		padding: 1.5vh 1.5vw;
		background: rgba(0, 0, 0, 0.1);
		border-radius: 15px;
		backdrop-filter: blur(10px);
		border: 1px solid rgba(255, 255, 255, 0.1);
		/* è‡ªåŠ¨ç¼©æ”¾æ§åˆ¶ */
		transform: scale(1);
		transform-origin: bottom right;
	}

	.virtual-controls .control-button {
		/* ä½¿ç”¨è§†å£å•ä½å®ç°è‡ªåŠ¨ç¼©æ”¾ */
		width: min(8vw, 8vh, 60px);
		height: min(8vw, 8vh, 60px);
		background: rgba(255, 255, 255, 0.3);
		border: 2px solid rgba(255, 255, 255, 0.6);
		border-radius: 50%;
		color: white;
		font-size: min(4vw, 4vh, 20px);
		cursor: pointer;
		display: flex;
		align-items: center;
		justify-content: center;
		backdrop-filter: blur(10px);
		transition: all 0.2s ease;
		box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
		position: relative;
		overflow: hidden;
		touch-action: manipulation;
		-webkit-tap-highlight-color: transparent;
	}

		.virtual-controls .control-button::before {
			content: '';
			position: absolute;
			top: 50%;
			left: 50%;
			width: 0;
			height: 0;
			background: rgba(255, 255, 255, 0.3);
			border-radius: 50%;
			transform: translate(-50%, -50%);
			transition: all 0.3s ease;
		}

		.virtual-controls .control-button:active::before {
			width: 100%;
			height: 100%;
		}

		.virtual-controls .control-button.active {
			background: rgba(255, 255, 255, 0.4);
			transform: scale(0.95);
		}

		.virtual-controls .control-button.special {
			width: min(10vw, 10vh, 80px);
			height: min(10vw, 10vh, 80px);
			background: rgba(255, 215, 0, 0.3);
			border-color: rgba(255, 215, 0, 0.7);
			font-size: min(5vw, 5vh, 24px);
		}

		/* åŠ›åº¦æ˜¾ç¤º */
		.power-indicator {
			position: absolute;
			top: -8px;
			right: -8px;
			width: min(5vw, 5vh, 20px);
			height: min(5vw, 5vh, 20px);
			background: rgba(255, 69, 0, 0.8);
			border-radius: 50%;
			display: none;
			align-items: center;
			justify-content: center;
			font-size: min(2.5vw, 2.5vh, 10px);
			color: white;
			font-weight: bold;
		}

		.power-indicator.visible {
			display: flex;
			animation: pulse 0.5s ease-in-out infinite alternate;
		}

		@keyframes pulse {
			from { transform: scale(1); }
			to { transform: scale(1.2); }
		}

		/* æ¸¸æˆçŠ¶æ€æ˜¾ç¤º - è‡ªåŠ¨ç¼©æ”¾é€‚é… */
		.game-status {
			position: fixed;
			top: 2vh;
			left: 2vw;
			z-index: 1000;
			color: white;
			font-size: min(3.5vw, 2vh, 16px);
			font-weight: bold;
			text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
			background: rgba(0, 0, 0, 0.4);
			padding: 1.5vh 1.5vw;
			border-radius: 10px;
			backdrop-filter: blur(10px);
			line-height: 1.5;
			display: none;
			min-width: min(35vw, 140px);
			border: 1px solid rgba(255, 255, 255, 0.1);
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
			transform: scale(1);
			transform-origin: top left;
		}

		.game-status div {
			margin: 0.5vh 0;
			white-space: nowrap;
		}

		.game-status span {
			color: #4CAF50;
			font-weight: bold;
		}

		/* æ¸…ç†ä¹‹å‰çš„å›ºå®šå°ºå¯¸åª’ä½“æŸ¥è¯¢ï¼Œä½¿ç”¨æ–°çš„æ™ºèƒ½ç¼©æ”¾ç³»ç»Ÿ */
	</style>
</head>
<body>
	<div id = "container"></div>
<div id = "fps" style = "position:absolute"></div>

<!-- ç«–å±æ¨¡å¼æç¤º -->
<div class="portrait-warning" id="portraitWarning">
    <div class="portrait-warning-icon">ğŸ“±</div>
    <div class="portrait-warning-text">è¯·å°†è®¾å¤‡æ—‹è½¬è‡³æ¨ªå±æ¨¡å¼<br>ä»¥è·å¾—æœ€ä½³æ¸¸æˆä½“éªŒ</div>
</div>
	
	<!-- ç§»åŠ¨ç«¯è™šæ‹Ÿæ§åˆ¶å™¨ -->
	<div class="virtual-controls" id="virtualControls">
		<button class="control-button" id="powerBtn" title="åŠ›åº¦">
			âš¡
			<div class="power-indicator" id="powerIndicator">0</div>
		</button>
		<button class="control-button special" id="shootBtn" title="å‡»çƒ">ğŸ±</button>
		<button class="control-button" id="resetBtn" title="é‡æ–°å¼€å§‹">ğŸ”„</button>
	</div>

	<!-- æ¸¸æˆçŠ¶æ€æ˜¾ç¤º -->
	<div class="game-status" id="gameStatus">
		<div>ğŸ± å°çƒæ¸¸æˆ</div>
		<div>å¾—åˆ†: <span id="scoreDisplay">0</span></div>
		<div>çƒæ•°: <span id="ballsDisplay">7</span></div>
		<div>çŠ¶æ€: <span id="gameState">å‡†å¤‡å¼€å§‹</span></div>
	</div>

	<script src = "src/quark.base-1.0.0.alpha.min.js"></script>
	<script src = "Taiqiu.js"></script>
	<script src = "mobile-adaptation.js"></script>
	<!-- ç®€åŒ–çš„å…¨å±åŠŸèƒ½å®ç° -->
	<script>
		window.FullscreenUtils = {
			initFullscreen: function(containerId, gameTitle) {
				console.log('å…¨å±åŠŸèƒ½åˆå§‹åŒ– - ' + gameTitle);
			}
		};
	</script>
	
	<!-- ç§»åŠ¨ç«¯ä¼˜åŒ–è„šæœ¬ -->
	<script>
		// ç®€åŒ–çš„ç§»åŠ¨è®¾å¤‡æ£€æµ‹
		function isMobileDevice() {
			return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|Tablet/i.test(navigator.userAgent) || 
				   (window.innerWidth < 768 && 'ontouchstart' in window);
		}
		
		// åˆå§‹åŒ–è™šæ‹Ÿæ§åˆ¶å™¨
		function initVirtualControls() {
			const shootBtn = document.getElementById('shootBtn');
			const resetBtn = document.getElementById('resetBtn');
			
			// å‡»çƒæŒ‰é’®
			shootBtn.addEventListener('touchstart', function(e) {
				e.preventDefault();
				if (window.BallGame && BallGame.canShot && !BallGame.paused) {
					// ä½¿ç”¨æ™ºèƒ½å‡»çƒåŠŸèƒ½
					if (BallGame.smartShoot) {
						BallGame.smartShoot();
					}
				}
			});
			shootBtn.addEventListener('click', function(e) {
				e.preventDefault();
				if (window.BallGame && BallGame.canShot && !BallGame.paused) {
					if (BallGame.smartShoot) {
						BallGame.smartShoot();
					}
				}
			});
			
			// é‡æ–°å¼€å§‹æŒ‰é’®
			resetBtn.addEventListener('touchstart', function(e) {
				e.preventDefault();
				if (window.BallGame && BallGame.reset) {
					BallGame.reset();
				}
			});
			resetBtn.addEventListener('click', function(e) {
				e.preventDefault();
				if (window.BallGame && BallGame.reset) {
					BallGame.reset();
				}
			});
		}
		
		// æ¸¸æˆåˆå§‹åŒ–å‡½æ•°
		function initGameUI() {
			try {
				// ç­‰å¾…BallGameå¯¹è±¡å®Œå…¨åˆå§‹åŒ–
				const checkBallGame = setInterval(() => {
					if (window.BallGame && BallGame.stage) {
						clearInterval(checkBallGame);
						console.log('BallGameå¯¹è±¡å·²åˆå§‹åŒ–ï¼Œå¼€å§‹åˆå§‹åŒ–UI');
						
						// åˆå§‹åŒ–è™šæ‹Ÿæ§åˆ¶å™¨
						initVirtualControls();
						
						// å¦‚æœæ˜¯ç§»åŠ¨è®¾å¤‡ï¼Œæ˜¾ç¤ºè™šæ‹Ÿæ§åˆ¶å™¨
						if (isMobileDevice()) {
							document.getElementById('virtualControls').style.display = 'flex';
							document.body.style.touchAction = 'manipulation';
							console.log('ç§»åŠ¨ç«¯é€‚é…å·²å¯ç”¨');
						}
						
						// æ˜¾ç¤ºæ¸¸æˆçŠ¶æ€
						document.getElementById('gameStatus').style.display = 'block';
					}
				}, 100);
			} catch (error) {
				console.error('æ¸¸æˆUIåˆå§‹åŒ–å¤±è´¥:', error);
			}
		}
		
		// é¡µé¢åŠ è½½å®Œæˆåå¼€å§‹UIåˆå§‹åŒ–
		// æ³¨æ„ï¼šTaiqiu.jså·²ç»æœ‰è‡ªå·±çš„onloadäº‹ä»¶å¤„ç†å‡½æ•°ï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨DOMContentLoadedç¡®ä¿ä¸ä¼šå†²çª
		document.addEventListener('DOMContentLoaded', function() {
			console.log('DOMå†…å®¹åŠ è½½å®Œæˆï¼Œå‡†å¤‡åˆå§‹åŒ–æ¸¸æˆUI');
			initGameUI();
		});
	</script>
</body>
</html>